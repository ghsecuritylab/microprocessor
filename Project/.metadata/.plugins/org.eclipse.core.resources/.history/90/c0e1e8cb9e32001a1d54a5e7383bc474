#include "stm32l476xx.h"
#include "utility.h"

extern void gpio_init();
extern void test();

int Distance;

int main(void) {
	fpu_enable();
	gpio_init();
	timer_init();
	counter_init();
	//test(100, HCSR04GetDistance(), 10);
	//test(100, SW420Vibration(), 10);
	//test(100, VoiceDetection(), 100);
	//test(100, PressDetection(), 100);
	TIM2->PSC = (uint32_t) (4000000 / RE / 100);
	TIM2->CCR2 = DUTY_CYCLE;
	TIM2->CR1 |= TIM_CR1_CEN;

	while(1){
		if(PressDetection()) TIM2->CR1 &= ~TIM_CR1_CEN;
	}
}


